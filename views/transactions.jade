extends layout

block nav
    li.active
        a(href="#") Transactions
    li
        a(href="/account-info") Account info
    li
        a(href="/buy-and-sell") Buy and Sell

block content
    h1 Robocoin Transactions
    form(role="form" action="#").form-inline.transaction-filter
        button.btn.btn-default By Date
        .form-group
            input(type="datetime-local").form-control
    form(role="form").form-inline.transaction-filter
        button.btn.btn-default Since Transaction
        .form-group
            input(type="text").form-control
    table.table.table-striped.table-condensed.hidden
        tr
            th Transaction ID
            th Action
            th Fiat
            th XBT
            th Time

block footerJs
    script.
        $('.transaction-filter button').on('click', function (event) {

            event.preventDefault();
            $('table').removeClass('hidden').addClass('show');

            $.ajax({
                url: '/robocoin/transactions',
                dataType: 'json',
                success: function (data) {

                    var transaction;
                    var rows = [];
                    var $row;

                    for (var i = 0; i < data.length; i++) {

                        transaction = data[i];

                        $row = $('<tr></tr>')
                            .addClass(transaction.action)
                            .addClass('transactionRow')
                            .append('<td>' + transaction.id + '</td>')
                            .append('<td>' + transaction.action + '</td>')
                            .append('<td>' + transaction.fiat + '</td>')
                            .append('<td>' + transaction.xbt + '</td>')
                            .append('<td>' + (new Date(transaction.time)).toUTCString() + '</td>');
                        rows.push($row);
                    }

                    $('table .transactionRow').remove();
                    $('table').append(rows);
                }
            });
        });